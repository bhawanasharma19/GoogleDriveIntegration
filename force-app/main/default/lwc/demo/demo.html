<template>
    <lightning-card title="Google Drive Files">
        <template if:true={isNewUser}>
            <lightning-button label="Add User Details" onclick={handleNewUser}></lightning-button>
        </template>
        <template if:true={isAuthenticate}>
            <lightning-button label="Authenticate User" onclick={handleAuthClick}></lightning-button>
        </template>
        <template if:true={isPreview}>
            <lightning-button label="Close Preview" onclick={closePreview}></lightning-button>
        </template>
        <template if:true={isModalOpen}>
            <section role="dialog" tabindex="-1" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <header class="slds-modal__header">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closeModal}>
                            <lightning-icon icon-name="utility:close" alternative-text="close" size="small"></lightning-icon>
                            <span class="slds-assistive-text">Close</span>
                        </button>
                        <h2 class="slds-text-heading_medium">Enter User Details</h2>
                    </header>
                    <div class="slds-modal__content slds-p-around_medium">
                        <lightning-input label="Client ID" value={clientKey} onchange={handleClientIdChange}></lightning-input>
                        <lightning-input label="Client Secret" value={clientSecret} onchange={handleClientSecretChange}></lightning-input>
                    </div>
                    <footer class="slds-modal__footer">
                        <lightning-button label="Save" onclick={handleSaveDetails} disabled={isSaveDisabled}></lightning-button>
                    </footer>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </template>
        <template if:true={filesData}>
            <template if:true={isViewingFiles}>
                <div class="breadcrumbs">
                    <template for:each={breadCrumb} for:item="crumb">
                        <span key={crumb.Id} class="breadcrumb-item">{crumb.name}</span>
                        <template if:true={crumb.isLastItem}>
                            <span key={crumb.Id} class="breadcrumb-separator"> > </span>
                        </template>
                    </template>
                </div>
                <template for:each={filesData} for:item="file">
                    <lightning-tile key={file.Id} label={file.Name} href={file.WebViewLink}>
                        <lightning-button-icon icon-name="utility:preview" alternative-text="Preview" title="Preview" onclick={handlePreview} data-id={file.Id} data-mimetype={file.MimeType} data-name={file.Name}></lightning-button-icon>
                        <lightning-button-icon icon-name="utility:delete" alternative-text="Delete" title="Delete" onclick={handleDelete} data-id={file.Id}></lightning-button-icon>
                        <lightning-button-icon icon-name="utility:edit" alternative-text="Rename" title="Rename" onclick={handleRenameMode} data-id={file.Id}></lightning-button-icon>
                    </lightning-tile>
                </template>
            </template>
            <template if:true={isViewingFolders}>
                <template for:each={foldersData} for:item="folder">
                    <lightning-tile key={folder.key} label={folder.value.Name} href={folder.value.WebViewLink}>
                        <lightning-button-icon icon-name="utility:preview" alternative-text="Preview" title="Preview" onclick={handlePreview} data-id={folder.key} data-mimetype={folder.value.MimeType} data-name={folder.value.Name}></lightning-button-icon>
                    </lightning-tile>
                </template>
            </template>
        </template>
    </lightning-card>
    
</template>
